"use strict";(self.webpackChunkxin_documentation=self.webpackChunkxin_documentation||[]).push([[109],{5404:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>c});var r=s(6672);const i={},t=r.createContext(i);function d(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(t.Provider,{value:n},e.children)}},8949:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>x,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"request","title":"\u8bf7\u6c42\u54cd\u5e94","description":"XinAdmin \u57fa\u4e8e Axios \u5c01\u88c5\u4e86\u4e00\u5957\u7f51\u7edc\u8bf7\u6c42 createAxios \u548c useRequest\uff1a","source":"@site/docs-ui/request.md","sourceDirName":".","slug":"/request","permalink":"/ui/request","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"introduceSidebar","previous":{"title":"\u5d4c\u5957\u8def\u7531","permalink":"/ui/rule-route/nested-route"},"next":{"title":"\u72b6\u6001\u7ba1\u7406","permalink":"/ui/stores"}}');var i=s(3420),t=s(5404);const d={sidebar_position:10},c="\u8bf7\u6c42\u54cd\u5e94",o={},l=[{value:"\u54cd\u5e94\u53c2\u6570",id:"\u54cd\u5e94\u53c2\u6570",level:3},{value:"createAxios",id:"createaxios",level:3},{value:"useRequest",id:"userequest",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u8bf7\u6c42\u54cd\u5e94",children:"\u8bf7\u6c42\u54cd\u5e94"})}),"\n",(0,i.jsxs)(n.p,{children:["XinAdmin \u57fa\u4e8e Axios \u5c01\u88c5\u4e86\u4e00\u5957\u7f51\u7edc\u8bf7\u6c42 ",(0,i.jsx)(n.code,{children:"createAxios"})," \u548c ",(0,i.jsx)(n.code,{children:"useRequest"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u81ea\u52a8\u53d6\u6d88\u91cd\u590d\u8bf7\u6c42"}),"\n",(0,i.jsx)(n.li,{children:"\u81ea\u52a8\u9519\u8bef/\u5f02\u5e38\u63d0\u793a"}),"\n",(0,i.jsx)(n.li,{children:"\u81ea\u52a8 loading"}),"\n",(0,i.jsx)(n.li,{children:"\u7b80\u6d01 data"}),"\n",(0,i.jsx)(n.li,{children:"\u81ea\u52a8\u643a\u5e26 token"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u54cd\u5e94\u53c2\u6570",children:"\u54cd\u5e94\u53c2\u6570"}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u4eec\u7ea6\u5b9a\u540e\u7aef\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4ee5\u4e0b\u662f\u54cd\u5e94JSON\u7684\u683c\u5f0f\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"declare namespace API {\n\n  type ErrorShowType =\n    | 0      // Success Message\n    | 1      // Warning Message\n    | 2      // Error Message\n    | 3      // Success Notification\n    | 4      // Warning Notification\n    | 5      // Error Notification\n    | 99;    // Other\n\n  /** List response data format */\n  type ListResponse<T> = {\n    data: T[]\n    page: number\n    total: number\n    per_page: number\n    current_page: number\n  }\n\n  /** The response data format agreed upon with the back end */\n  interface ResponseStructure<T> {\n    success: boolean\n    data: T\n    errorCode?: number\n    msg?: string\n    showType?: ErrorShowType\n    status?: number\n    description?: string\n    placement?: 'top' | 'topLeft' | 'topRight' | 'bottom' | 'bottomLeft' | 'bottomRight',\n  }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5176\u4e2d ",(0,i.jsx)(n.code,{children:"success"})," \u4e0e ",(0,i.jsx)(n.code,{children:"data"})," \u4e3a\u5fc5\u987b\u7684\u5b57\u6bb5\uff0c\u5176\u4ed6\u5b57\u6bb5\u4e3a\u53ef\u9009\u5b57\u6bb5\uff0cXinAdmin \u6839\u636e\u8fd9\u4e2a\u7c7b\u578b\u6765\u81ea\u52a8\u5904\u7406\u9519\u8bef\u3002"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u53c2\u6570\u8be6\u89e3\uff1a"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u53c2\u6570"}),(0,i.jsx)(n.th,{children:"\u662f\u5426\u5fc5\u987b"}),(0,i.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"success"}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"\u4e1a\u52a1\u8bf7\u6c42\u662f\u5426\u6210\u529f"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"data"}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"\u4e1a\u52a1\u8bf7\u6c42\u8fd4\u56de\u7684\u6570\u636e"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"errorCode"}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"\u9519\u8bef\u72b6\u6001\u7801"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"msg"}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"\u9519\u8bef\u63d0\u793a"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"showType"}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"\u5f02\u5e38\u663e\u793a\u7c7b\u578b"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"status"}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"\u8bf7\u6c42\u72b6\u6001"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"description"}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"\u8bf7\u6c42\u63cf\u8ff0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"placement"}),(0,i.jsx)(n.td,{children:"\u274c"}),(0,i.jsx)(n.td,{children:"\u63d0\u793a\u4f4d\u7f6e"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"createaxios",children:"createAxios"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"createAxios"})," \u7528\u6765\u5b9a\u4e49\u8bf7\u6c42\u65b9\u6cd5\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a Promise \u5bf9\u8c61\uff0c\u5728 ",(0,i.jsx)(n.code,{children:"src/api"})," \u76ee\u5f55\u4e2d\u5b58\u653e\u4e86\u7cfb\u7edf\u6240\u6709\u7684\u7f51\u7edc\u8bf7\u6c42\u51fd\u6570\uff0c\u6211\u4eec\u4e5f\u5efa\u8bae\u60a8\u5c06\u5c01\u88c5\u7684\u8bf7\u6c42\u51fd\u6570\u653e\u7f6e\u4e8e\u6b64\u76ee\u5f55\u4e0b\n\u4ee5\u4fbf\u4e8e Api \u7684\u7ba1\u7406\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49\u8bf7\u6c42\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// src/api/index.ts\nimport { createAxios } from '@/utils/request.ts';\n\nexport function myApi() {\n  return createAxios({\n    url: '/your/api/path',\n    method: 'get',\n  });\n}\n\n// \u76f4\u63a5\u4f7f\u7528\nmyApi.then(res => {\n  console.log(res)\n})\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"createAxios"})," \u53c2\u6570\u7528\u4e8e\u81ea\u5b9a\u4e49 ",(0,i.jsx)(n.code,{children:"axios"})," \u914d\u7f6e\u53ef\u7528\u914d\u7f6e\u9879 \u8bf7\u53c2\u8003",(0,i.jsx)(n.a,{href:"https://www.axios-http.cn/docs/req_config",children:"Axios\u7f51\u7ad9"}),"\uff0c\u53ea\u6709 url \u662f\u5fc5\u9700\u7684\uff0c\u9ed8\u8ba4\u8bf7\u6c42\u65b9\u6cd5\u4e3a get\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"createAxios({\n    url: '/index.php/admin/auth.menu/index',\n    method: 'get',\n    timeout: 3000, // \u8bf7\u6c42\u8d85\u65f6\u6beb\u79d2\u6570\uff0c\u53ef\u8986\u76d6\u9ed8\u8ba4\u7684\u8d85\u65f6\u8bbe\u5b9a\n    // ...\n})\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"axios.create"})," \u6765\u6df1\u5ea6\u81ea\u5b9a\u4e49\u4f60\u7684\u8bf7\u6c42\uff0c\u8bf7\u53c2\u8003 ",(0,i.jsx)(n.a,{href:"https://axios-http.com/zh/docs/intro",children:"Axios \u6587\u6863"}),"\u3002"]})}),"\n",(0,i.jsx)(n.h3,{id:"userequest",children:"useRequest"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"useRequest"})," \u7528\u6765\u8fdb\u4e00\u6b65\u7684\u5904\u7406\u8bf7\u6c42\u7ed3\u679c\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a ",(0,i.jsx)(n.code,{children:"useRequest"})," \u5bf9\u8c61\uff0c\u4ed6\u53ef\u4ee5\u8fd4\u56de\u7b80\u6d01\u7684 ",(0,i.jsx)(n.code,{children:"data"}),"\uff0c\u5e76\u81ea\u52a8\u5904\u7406 ",(0,i.jsx)(n.code,{children:"loading"}),"\uff0c\u8be5\u5bf9\u8c61\u5305\u542b\u4ee5\u4e0b\u5c5e\u6027\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"data"}),": \u8bf7\u6c42\u7ed3\u679c\u6570\u636e"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"loading"}),": \u8bf7\u6c42\u52a0\u8f7d\u72b6\u6001"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"success"}),": \u8bf7\u6c42\u662f\u5426\u6210\u529f"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"error"}),": \u8bf7\u6c42\u5931\u8d25\u54cd\u5e94"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"run"}),": \u624b\u52a8\u6267\u884c\u8bf7\u6c42"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"import { myApi } from '@/api/index.ts';\nimport useRequest from '@/utils/useRequest.ts';\n\nconst {data, loading, success, error, run} = useRequest(myApi, {\n  manual: true,\n  onSuccess: (res) => {\n    console.log(res);\n  },\n  onError: (err) => {\n    console.log(err);\n  }\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u53c2\u6570\u8bf4\u660e\uff1a"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"apiFunction"}),"\uff1a \u8bf7\u6c42\u7684\u51fd\u6570\uff0c\u7531 ",(0,i.jsx)(n.code,{children:"createAxios"})," \u521b\u5efa\u7684\u63a5\u53e3\u51fd\u6570"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"options"}),": \u8bf7\u6c42\u7684\u914d\u7f6e\u9879"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"options"}),".",(0,i.jsx)(n.code,{children:"manual"}),": \u662f\u5426\u81ea\u52a8\u6267\u884c\u8bf7\u6c42\uff0c\u9ed8\u8ba4\u4e3a false"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"options"}),".",(0,i.jsx)(n.code,{children:"onSuccess"}),": \u8bf7\u6c42\u6210\u529f\u56de\u8c03"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"options"}),".",(0,i.jsx)(n.code,{children:"onError"}),": \u8bf7\u6c42\u5931\u8d25\u56de\u8c03"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"options"}),".",(0,i.jsx)(n.code,{children:"onFinally"}),": \u8bf7\u6c42\u7ed3\u675f\u56de\u8c03"]}),"\n"]}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);